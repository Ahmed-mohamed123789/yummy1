<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="index.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <title>details</title>
</head>

<body class="bg-black text-white">
  <div class="container mt-5">
    <div class="row">
      <div class="col-md-12 col-sm-12 col-lg-4">
        <div class="inhher">
          <img id="mealImage" src="" class="w-100 rounded-4" alt="">
          <h2 id="mealTitle"></h2>
        </div>
      </div>

      <div class="col-md-12 col-sm-12 col-lg-8">
        <div class="inhher">
          <h4 class="">Instructions</h4>
          <p id="instructions"></p>

          <h4><strong>Area :</strong> <span id="area"></span></h4>
          <h4><strong>Category :</strong> <span id="category"></span></h4>

          <div class="mb-3">
            <h4><strong>Recipes :</strong></h4>
            <div id="ingredients" class="d-flex flex-wrap gap-2"></div>
          </div>

          <div class="mb-3">
            <h4 class="fs-3 fw-bold">Tags :</h4>
            <div id="tags" class="d-flex gap-2"></div>
          </div>

          <div class="mt-3 d-flex gap-2 mb-4">
            <a id="sourceLink" href="#" class="btn btn-success px-3 py-2" target="_blank">Source</a>
            <a id="youtubeLink" href="#" class="btn btn-danger px-3 py-2" target="_blank">Youtube</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function () {
      // نجيب الـid من الـURL
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");

      if (!id) {
        console.error('No id found in URL. افتح الصفحة مع ?id=ID_الوجبة');
        return;
      }

      $.ajax({
        url: `https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`,
        method: 'GET',
        dataType: 'json',
        success: function (response) {
          if (!response || !response.meals) {
            console.error('No meal data returned for id:', id);
            return;
          }
          const meal = response.meals[0];

          $('#mealImage').attr('src', meal.strMealThumb);
          $('#mealTitle').text(meal.strMeal);
          $('#instructions').text(meal.strInstructions);
          $('#area').text(meal.strArea);
          $('#category').text(meal.strCategory);

          const $ingredients = $('#ingredients').empty();
          for (let i = 1; i <= 20; i++) {
            const ingredient = meal[`strIngredient${i}`];
            const measure = meal[`strMeasure${i}`];
            if (ingredient && ingredient.trim() !== "") {
              $ingredients.append(
                `<span class="badge bg-info text-dark">${measure} ${ingredient}</span>`
              );
            }
          }

          const $tags = $('#tags').empty();
          if (meal.strTags) {
            meal.strTags.split(',').forEach(tag => {
              $tags.append(`<span class="badge bg-secondary">${tag}</span>`);
            });
          }

          $('#sourceLink').attr('href', meal.strSource || '#');
          $('#youtubeLink').attr('href', meal.strYoutube || '#');
        },
        error: function () {
          console.error('حصل خطأ في جلب البيانات');
        }
      });
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
